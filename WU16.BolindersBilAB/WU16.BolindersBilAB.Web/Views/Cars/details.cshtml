@model WU16.BolindersBilAB.DAL.Models.Car
@{
    ViewData["Title"] = $"{Model.CarBrand.BrandName} {Model.Model} {Model.ModelYear}";

    var taxedPrice = Math.Round(Model.Price * 1.25m, 2);
    var cashPayment = Math.Round(taxedPrice * 0.2m, 2).ToString(new System.Globalization.CultureInfo("en-US"));

    var anyImages = Model.CarImages != null ? Model.CarImages.Any() : false;
    string[] imageUrls = null;
    if (anyImages)
    {
        imageUrls = Model.CarImages.Select(x => $"/images/{x.Id}.jpg").ToArray();
    }

    var condition = Model.Used ? "Begagnad" : "Ny";
}

<div class="container" id="cars-details-container">
    @* Image display *@
    <div class="row image-container">
        @if (anyImages)
        {
            <div class="current-image col-xl-8 col-lg-8 col-md-8 col-sm-12">
                <img src="@imageUrls.First()" />
            </div>

            <div class="image-preview col-xl-4 col-lg-4 col-md-4 col-sm-12 align-self-end">
                @foreach (var url in imageUrls)
                {
                    <img src="@url" />
                }
            </div>
        }
        else
        {
            <div class="no-images col-12">
                <p>
                    <i class="fa fa-file-image-o"></i> Inga bilder upplaggda än.
                </p>
            </div>
        }
    </div>
    @* /Image display *@

    
    <div class="row">
        @* Main Content *@
        <main class="col-xl-8 col-lg-8 col-md-8 ">
            <h1>
                @ViewData["Title"]

                <button class="share-button btn btn-primary float-right">
                    <i class="fa fa-share"></i>
                </button>
            </h1>

            <p>
                @Model.Description
            </p>

            <div>
                @foreach (var e in Model.Equipment.Split("|"))
                {
                    <span class="badge badge-success">@e</span>
                }
            </div>
        </main>
        @* /Main Content *@

        @* Information table *@
        <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12 col-xs-12 px-0">
            <table class="information-table table table-bordered">
                <thead>
                    <tr>
                        <th colspan="2">
                            Allmän Information
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Registrerings Nummer</td>
                        <td>@Model.LicenseNumber</td>
                    </tr>
                    <tr>
                        <td>Märke</td>
                        <td>@Model.CarBrand.BrandName</td>
                    </tr>
                    <tr>
                        <td>Model</td>
                        <td>@Model.Model</td>
                    </tr>
                    <tr>
                        <td>Årsmodell</td>
                        <td>@Model.ModelYear</td>
                    </tr>
                    <tr>
                        <td>Färg</td>
                        <td>@Model.Color</td>
                    </tr>
                    <tr>
                        <td>Växellåda</td>
                        <td>@Model.Gearbox.ToString()</td>
                    </tr>
                    <tr>
                        <td>Hästkrafter</td>
                        <td>@Model.HorsePower hk</td>
                    </tr>
                    <tr>
                        <td>Biltyp</td>
                        <td>@Model.CarType.ToString()</td>
                    </tr>
                    <tr>
                        <td>Miltal</td>
                        <td>@Model.Milage</td>
                    </tr>
                    <tr>
                        <td>Bränsletyp</td>
                        <td>@Model.FuelType.ToString()</td>
                    </tr>
                    <tr>
                        <td>Ny/Begagnad</td>
                        <td>@condition</td>
                    </tr>
                    <tr>
                        <td>Pris</td>
                        <td>@taxedPrice kr</td>
                    </tr>
                    @if (Model.IsLeaseable)
                    {
                        <tr>
                            <td>Leasing Pris</td>
                            <td>@Model.Price kr</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
        @* /Information table *@
    </div>
    @* /Main Content *@

    @* Price Calculator *@
    <div class="row price-calculator">
        <div class="col-xl-8 col-lg-8 col-md-8 col-sm-12">
            <form class="form">
                <input type="hidden" value="@taxedPrice" />

                <div class="col-12 form-group">
                    <div class="input-group">
                        <div class="input-group-addon">Kontant</div>
                        <input type="number" value="@cashPayment" class="form-control" />
                        <div class="input-group-addon">Kr</div>
                    </div>
                </div>

                <div class="col-12 form-group">
                    <div class="input-group">
                        <div class="input-group-addon">Avbetalnigs längd</div>
                        <select class="custom-select form-control">
                            <option value="12">12 månader</option>
                            <option value="24">24 månader</option>
                            <option selected="selected" value="36">36 månader</option>
                            <option value="48">48 månader</option>
                            <option value="48">48 månader</option>
                            <option value="72">72 månader</option>
                        </select>
                    </div>
                </div>

                <div class="col-12 form-group">
                    <button class="btn btn-block btn-primary">Räkna ut</button>
                </div>
            </form>
        </div>
        <div class="col-md-4 col-sm-12 price-result justify-content-sm-start">
            <p class="month"></p>
            <p class="total"></p>
            <p>Kontakta säljare: <a href="tel:@Model.Location.PhoneNumber">@Model.Location.PhoneNumber</a></p>
        </div>
    </div>
    @* /Price Calculator *@
</div>

@section Scripts {
    <script src="~/js/_cars-details.js" asp-append-version="true"></script>
}